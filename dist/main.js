(()=>{const e="http://127.0.0.1:8082/src/data/",t=e+"all_time_sets.json",n=e+"all_time_games.json",o=e+"season_to_date_sets.json",a=e+"season_to_date_games.json",s=e+"all_time_rankings.json",i=document.querySelectorAll("select"),l=document.getElementById("player_one"),r=document.getElementById("player_two"),d=document.getElementById("data"),c="Player One",f="Player Two";function p(e){return e.includes(" | ")&&(e=e.split(" | ").pop()),e}function u(e){d.innerHTML=e,console.log(e)}function g(e,t){delete e[t].field1,delete e[t].field2,delete e[t].field22}!async function(){try{u("Attempting to pull data...");const e=await fetch(t),m=await fetch(n),S=await fetch(o),h=await fetch(a),w=await fetch(s);if(!e.ok)throw new Error(`She's broke bahd! Response status: ${e.status}`);if(!m.ok)throw new Error(`She's broke bahd! Response status: ${m.status}`);if(!S.ok)throw new Error(`She's broke bahd! Response status: ${S.status}`);if(!h.ok)throw new Error(`She's broke bahd! Response status: ${h.status}`);if(!w.ok)throw new Error(`She's broke bahd! Response status: ${w.status}`);u("Responses OK, pulling data...");const $=await e.json(),b=await m.json(),H=await S.json(),y=await h.json(),L=await w.json();u("Creating Head 2 Head JSON: Adding players...");let k={};for(const e in L){let t=L[e].Player,n="";if(t.includes(" | ")){let e=t.split(" | ");t=e[1],n=e[0]}k[t]={Characters:L[e].Characters,Country:L[e].Country,GameData:{Lifetime:{},Seasonal:{}},Points:L[e].Points,PlayerName:t,Rank:L[e].Rank,Tag:n,SetData:{Lifetime:{},Seasonal:{}}}}u("Cleaning the data..."),$[0],b[0],H[0],y[0],delete $[0],delete b[0],delete H[0],delete y[0];for(const e in $){let t=$[e].field2;t=p(t),$[t]=$[e],delete $[e]}for(const e in b){let t=b[e].field2;t=p(t),b[t]=b[e],delete b[e]}for(const e in H){let t=H[e].field2;t=p(t),H[t]=H[e],delete H[e]}for(const e in y){let t=y[e].field2;t=p(t),y[t]=y[e],delete y[e]}for(const e in $)for(const t in $[e])console.group(),console.log(e),console.log(t),console.log($[e]),console.log($[e][t]),console.groupEnd(),$[e][e]={},$[e][e]=$[e][t];console.group(),console.log($),console.groupEnd();for(const e in b);for(const e in H);for(const e in y);u("Creating Head 2 Head JSON: Adding Lifetime Sets data...");for(const e in $)if(0==e)delete $[e];else{let t=$[e].field2;$[e].field2.includes(" | ")&&(t=$[e].field2.split(" | ").pop()),g($,e),k[t].SetData.Lifetime=$[e]}u("Creating Head 2 Head JSON: Adding Seasonal Set data...");for(const e in H)if(0==e)delete H[e];else{let t=H[e].field2;H[e].field2.includes(" | ")&&(t=H[e].field2.split(" | ").pop()),g(H,e),k[t].SetData.Seasonal=H[e]}u("Creating Head 2 Head JSON: Adding Lifetime Game data...");for(const e in b)if(0==e)delete b[e];else{let t=b[e].field2;b[e].field2.includes(" | ")&&(t=b[e].field2.split(" | ").pop()),g(b,e),k[t].GameData.Lifetime=b[e]}u("Creating Head 2 Head JSON: Adding Seasonal Game data...");for(const e in y)if(0==e)delete y[e];else{let t=y[e].field2;y[e].field2.includes(" | ")&&(t=y[e].field2.split(" | ").pop()),g(y,e),k[t].GameData.Seasonal=y[e]}u("Head 2 Head JSON compiled, creating option elements..."),console.group("Head 2 Head JSON"),console.log(k),console.groupEnd(),l.innerHTML+=`<option>${c}</option>`,r.innerHTML+=`<option>${f}</option>`;for(const e in k){let t=k[e].PlayerName,n=k[e].Rank;l.innerHTML+=`<option value="${n}">${t}</option>`,r.innerHTML+=`<option value="${n}">${t}</option>`}u("Finishing up..."),i.forEach((e=>{e.addEventListener("change",(function(){if(t=r,(e=l).options[e.selectedIndex].value!=c&&t.options[t.selectedIndex].value!=f){let e,t,n,o,a,s,i,c,f=l.options[l.selectedIndex].innerText,p=r.options[r.selectedIndex].innerText;for(const l in k)l==f&&(e=k[l].Rank,t=k[l].Characters,n=k[l].SetData.Lifetime,o=k[l].SetData.Seasonal,a=k[l].GameData.Lifetime,s=k[l].GameData.Seasonal),l==p&&(i=k[l].Rank,c=k[l].Characters);console.group("P1 LTG"),console.log(a),console.groupEnd(),d.innerHTML=`\n                    <article class="player-stats">\n                        <p>\n                            P1: ${f} (${t})\n                            <br>\n                            PR #${e}\n                            <br>\n                            <br>\n                            Lifetime Stats\n                            <br>\n                            Lifetime Sets: ${n}\n                            <br>\n                            Lifetime Games: ${a}\n                            <br>\n                            <br>\n                            Seasonal Stats\n                            <br>\n                            Seasonal Sets: ${o}\n                            <br>\n                            Seasonal Games: ${s}\n                        </p>\n                        <p>VS</p>\n                        <p>\n                            P1: ${p} (${c})\n                            <br>\n                            PR #${i}\n                        </p>\n                    </article>\n                    `}var e,t}))})),u("Ready! Awaiting player selection.")}catch(e){console.error(e.message)}}()})();